version: '3.5'

services:
  zookeeper:
    container_name: zookeeper
    image: wurstmeister/zookeeper
    ports:
     - 2181:2181
     - 2888:2888
     - 3888:3888

  kafka:
    container_name: kafka
    image: wurstmeister/kafka
    depends_on:
      - zookeeper
    ports:
      - '9092:9092'
    environment:
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://34.90.190.73:9092

  twitter-ingestion:
    container_name: twitter-ingestion
    build: 
      context: ./ingestion
      dockerfile: twitter.Dockerfile
    image: twitter-ingestion:latest
    depends_on:
      - kafka

  crypto-ingestion:
    container_name: crypto-ingestion
    build: 
      context: ./ingestion
      dockerfile: crypto.Dockerfile
    image: crypto-ingestion:latest
    depends_on:
      - kafka